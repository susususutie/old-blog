<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>001-jQuery-slider-img</title>
    <link rel="icon" type="image/x-icon" href="../src/img/icon.png" />

    <style>
        * {
            margin: 0px;
            padding: 0px;
        }

        .slider-wrapper {
            position: relative;
            width: 300px;
            height: 200px;
            margin-left: auto;
            margin-right: auto;
            overflow: hidden;
        }

        .slider-wrapper-ul {
            position: absolute;
            top: 0px;
            left: 0px;
            width: 1800px;
            height: 200px;
            overflow: hidden;
            list-style: none;
            font-size: 0px;
        }

        .slider-wrapper-ul-li {
            display: inline-block;
            width: 300px;
            height: 200px;
        }

        .slider-img {
            width: 300px;
            height: 200px;
        }

        .slider-wrapper-index {
            position: absolute;
            bottom: 10px;
            left: 50%;
            margin-left: -55px;
            background-color: #555;
            font-size: 0px;
            padding: 2px;
            border-radius: 13px;
            display: none;
        }

        .index-dots {
            display: inline-block;
            margin: 3px;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background-color: #fff;
        }

        .index-dots.active-dot {
            background-color: #333;
        }

        .slider-wrapper-left,
        .slider-wrapper-right {
            position: absolute;
            top: 85px;
            width: 20px;
            height: 30px;
            background-color: #555;
            display: none;
        }

        .slider-wrapper-left {
            left: 0px;
            cursor: pointer;
        }

        .slider-wrapper-right {
            right: 0px;
            cursor: pointer;
        }
    </style>
</head>

<body>

    <div class="slider-wrapper">
        <ul class="slider-wrapper-ul">
            <li class="slider-wrapper-ul-li"><img src="../src/img/1.jpg" class="slider-img"></li>
            <li class="slider-wrapper-ul-li"><img src="../src/img/2.jpg" class="slider-img"></li>
            <li class="slider-wrapper-ul-li"><img src="../src/img/3.jpg" class="slider-img"></li>
            <li class="slider-wrapper-ul-li"><img src="../src/img/4.jpg" class="slider-img"></li>
            <li class="slider-wrapper-ul-li"><img src="../src/img/5.jpg" class="slider-img"></li>
            <li class="slider-wrapper-ul-li"><img src="../src/img/1.jpg" class="slider-img"></li>
        </ul>
        <ul class="slider-wrapper-index">
            <li class="index-dots active-dot"></li>
            <li class="index-dots"></li>
            <li class="index-dots"></li>
            <li class="index-dots"></li>
            <li class="index-dots"></li>
        </ul>
        <div class="slider-wrapper-left">ğŸ‘ˆ</div>
        <div class="slider-wrapper-right">ğŸ‘‰</div>
    </div>

    <script src="../src/js/jquery-v3.4.0.min.js"></script>
    <script>

        var sliderWrapper = $(".slider-wrapper");
        var sliderUl = $(".slider-wrapper-ul");
        var sliderIndex = $(".slider-wrapper-index");
        var indexDots = $(".index-dots");
        var leftBtn = $(".slider-wrapper-left");
        var rightBtn = $(".slider-wrapper-right");

        var imgNum = $(".slider-wrapper-ul-li").length - 1;
        var steep = sliderUl.width() / (imgNum + 1);
        var oldIndex = undefined;
        var nowIndex = 0;
        var moveLock = true;
        var timer;

        bindEvents()
        autoMove("right")

        // äº‹ä»¶ç»‘å®š
        function bindEvents() {
            // é¼ æ ‡æ»‘å…¥äº‹ä»¶ ä½¿æ§ä»¶æ˜¾ç¤º
            sliderWrapper.on("mouseenter", function () {

                sliderIndex.add(leftBtn).add(rightBtn).show();

                // ç´¢å¼•æ§ä»¶ç‚¹å‡»äº‹ä»¶
                indexDots.on("click", function() {
                    if (moveLock) {
                        clearInterval(timer)
                        moveLock = false;
                        changeIndex($(this).index())
                        autoMove("right")
                    }
                });

                // å³æŒ‰é’®çš„è‡ªå®šä¹‰rightEventäº‹ä»¶ï¼Œulå³ç§»æ˜¾ç¤ºä¸‹ä¸€å¼ 
                rightBtn.on("rightEvent", function () {
                    if (moveLock) {
                        moveLock = false;
                        changeIndex((nowIndex + 1) % 5)
                    }
                });

                // å³æŒ‰é’®ç‚¹å‡»äº‹ä»¶ è§¦å‘rightEvent
                rightBtn.click(function () {
                    clearInterval(timer)
                    rightBtn.trigger("rightEvent");
                    autoMove("right")
                });

                // å·¦æŒ‰é’®çš„è‡ªå®šä¹‰leftEventäº‹ä»¶ï¼Œulå·¦ç§»æ˜¾ç¤ºä¸Šä¸€å¼ 
                leftBtn.on("leftEvent", function () {
                    if (moveLock) {
                        moveLock = false;
                        changeIndex((nowIndex + 4) % 5)
                    }
                });

                // å·¦æŒ‰é’®ç‚¹å‡»äº‹ä»¶ è§¦å‘leftEvent
                leftBtn.click(function () {
                    clearInterval(timer)
                    leftBtn.trigger("leftEvent");
                    autoMove("right")
                });

                // åŸå…ˆçš„å†™æ³•ï¼Œæ²¡æœ‰ç”¨triggerï¼Œç›´æ¥ç»‘å®šç‚¹å‡»äº‹ä»¶
                // leftBtn.add(rightBtn).on("click", function() {
                //     if ($(this).hasClass("slider-wrapper-left") && moveLock) {
                //         moveLock = false;
                //         changeIndex((nowIndex + 4) % 5)
                //     } else if ($(this).hasClass("slider-wrapper-right") && moveLock) {
                //         moveLock = false;
                //         changeIndex((nowIndex + 1) % 5)
                //     }
                // });
            })

            // é¼ æ ‡æ»‘å‡ºäº‹ä»¶ ä½¿æ§ä»¶éšè—ï¼Œåˆ é™¤æ§ä»¶æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ï¼Œä¸åˆ é™¤è‡ªå®šä¹‰äº‹ä»¶
            sliderWrapper.on("mouseleave", function () {
                sliderIndex.add(leftBtn).add(rightBtn).hide();
                leftBtn.add(rightBtn).off("click");
                indexDots.off("click");
            })
        }

        // ç§»åŠ¨å‡½æ•°ï¼ŒoldIndex --> nowIndexï¼Œå‡ºå‘ç´¢å¼•ä¸ç›®æ ‡ç´¢å¼•ä¸èƒ½ç›¸ç­‰
        function moveByIndex(oldIndex, nowIndex) {
            if (oldIndex == 0 && nowIndex == imgNum - 1) {
                sliderUl.css({left: - imgNum * steep}).animate({left: - nowIndex * steep}, 500, "swing", function() {
                    moveLock = true;
                })
            } else if (oldIndex == imgNum - 1 && nowIndex == 0) {
                sliderUl.animate({left: - (oldIndex + 1) * steep}, 500, "swing", function() {
                    $(this).css({left: 0})
                    moveLock = true;
                })
            } else {
                sliderUl.animate({left: - nowIndex * steep}, 500, "swing", function () {
                    moveLock = true;
                })
            }
        }

        // è‡ªåŠ¨åˆ‡æ¢å‡½æ•° deraction ==> "right" / "left"
        function autoMove(deraction) {
            clearInterval(timer)
            timer = setInterval(function() {
                $(".slider-wrapper-" + deraction).trigger(deraction + "Event");
            }, 1500)
        }

        // æ›´æ”¹ç´¢å¼•çŠ¶æ€ï¼Œå‡ºå‘ç´¢å¼•ä¸ç›®æ ‡ç´¢å¼•ä¸ç­‰æ—¶è°ƒç”¨ç§»åŠ¨å‡½æ•°moveByIndexï¼Œå‚æ•°ä¸ºæƒ³å»çš„ç›®æ ‡ç´¢å¼•
        function changeIndex(newindex) {
            if (newindex == nowIndex) {
                console.log("same index nochange")
            } else {
                oldIndex = nowIndex;
                nowIndex = newindex;
                // console.log("from: ", oldIndex, "to: ", newindex)
                indexDots.eq(oldIndex).removeClass("active-dot")
                indexDots.eq(nowIndex).addClass("active-dot")
                moveByIndex(oldIndex, nowIndex)
            }
        }

    </script>
</body>

</html>